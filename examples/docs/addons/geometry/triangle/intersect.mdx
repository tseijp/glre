---
title: 'intersect'
description: 'Ray-triangle intersection using Möller-Trumbore algorithm for 3D ray tracing'
keywords: [geometry, triangle, ray-tracing, intersection, moller-trumbore]
date: 2025-08-06
---

import { FragmentEditor } from '@site/src/theme/FragmentEditor'

# triangleIntersect: Ray-Triangle Intersection Algorithm

### Möller-Trumbore Method for Efficient Ray Testing

The triangle intersection function implements the Möller-Trumbore algorithm for computing ray-triangle intersections in 3D space. This method efficiently determines both intersection existence and parametric distance along the ray.

Given triangle vertices $A$, $B$, $C$ and ray with origin $O$ and direction $\vec{d}$, the algorithm computes edge vectors and cross products:

$$
\begin{align}
\vec{v_1} &= B - A \\
\vec{v_2} &= C - A \\
\vec{h} &= \vec{d} \times \vec{v_2} \\
\end{align}
$$

The determinant $a = \vec{v_1} \cdot \vec{h}$ determines ray-plane parallelism. When $|a|$ approaches zero, the ray lies parallel to the triangle plane.

**Barycentric Coordinate Calculation**

The algorithm computes barycentric coordinates $(u, v)$ within the triangle:

$$
\begin{align}
\vec{s} &= O - A \\
u &= \frac{\vec{s} \cdot \vec{h}}{a} \\
\vec{q} &= \vec{s} \times \vec{v_1} \\
v &= \frac{\vec{d} \cdot \vec{q}}{a}
\end{align}
$$

Valid intersections satisfy $u \geq 0$, $v \geq 0$, and $u + v \leq 1$.

**Distance Parameter**

The parametric distance $t$ along the ray is calculated as:

$$t = \frac{\vec{v_2} \cdot \vec{q}}{a}$$

When $t < 0$, the intersection occurs behind the ray origin. The function returns $t$ for valid intersections or a large value ($9999999.9$) for misses.

<FragmentEditor
        code={`
const fragment = () => Scope(() => {
        const tri = Triangle({
                a: vec3(-0.5, -0.4, 0),
                b: vec3(0.5, -0.4, 0),
                c: vec3(0, 0.6, 0)
        })
        const rayOrigin = vec3(uv.mul(2).sub(1), -1)
        const rayDir = vec3(0, 0, 1)
        const dist = triangleIntersect(tri, rayOrigin, rayDir)
        const hit = dist.step(1000)
        const depth = hit.mul(0.8).add(0.2)
        return vec4(vec3(depth), 1)
})`}
/>
