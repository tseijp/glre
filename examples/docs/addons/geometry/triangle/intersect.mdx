---
title: 'intersect'
description: 'Ray-triangle intersection using Möller-Trumbore algorithm for 3D ray tracing'
keywords: [geometry, triangle, ray-tracing, intersection, moller-trumbore]
date: 2025-08-06
---

import { FragmentEditor } from '@site/src/theme/FragmentEditor'

# triangleIntersect: Ray-Triangle Intersection Algorithm

### Möller-Trumbore Method for Efficient Ray Testing

The triangle intersection function implements the Möller-Trumbore algorithm for computing ray-triangle intersections in 3D space. This method efficiently determines both intersection existence and parametric distance along the ray.

Given triangle vertices $A$, $B$, $C$ and ray with origin $O$ and direction $\vec{d}$, the algorithm computes edge vectors and cross products:

$$
\begin{align}
\vec{v_1} &= B - A \\
\vec{v_2} &= C - A \\
\vec{h} &= \vec{d} \times \vec{v_2} \\
\end{align}
$$

The determinant $a = \vec{v_1} \cdot \vec{h}$ determines ray-plane parallelism. When $|a|$ approaches zero, the ray lies parallel to the triangle plane.

**Barycentric Coordinate Calculation**

The algorithm computes barycentric coordinates $(u, v)$ within the triangle:

$$
\begin{align}
\vec{s} &= O - A \\
u &= \frac{\vec{s} \cdot \vec{h}}{a} \\
\vec{q} &= \vec{s} \times \vec{v_1} \\
v &= \frac{\vec{d} \cdot \vec{q}}{a}
\end{align}
$$

Valid intersections satisfy $u \geq 0$, $v \geq 0$, and $u + v \leq 1$.

**Distance Parameter**

The parametric distance $t$ along the ray is calculated as:

$$t = \frac{\vec{v_2} \cdot \vec{q}}{a}$$

When $t < 0$, the intersection occurs behind the ray origin. The function returns $t$ for valid intersections or a large value ($9999999.9$) for misses.

<FragmentEditor
        code={`
const fragment = () => {
        const p = uv.mul(2).sub(1)
        const rayOrigin = vec3(p.mul(3), -5)
        const rayDir = vec3(0, 0, 1)
        const t = iTime.mul(2)
        const v1 = vec3(sin(t).mul(2), cos(t.mul(1.1)).mul(1.5), 0)
        const v2 = vec3(cos(t.mul(0.8)).mul(2.5), sin(t.mul(1.3)).mul(1.2), 0)  
        const v3 = vec3(sin(t.mul(1.2)).mul(1.8), cos(t.mul(0.9)).mul(2), 0)
        const dist = triangleIntersect(Triangle({ a: v1, b: v2, c: v3 }), rayOrigin, rayDir)
        const hit = step(dist, 100)
        const depth = dist.div(10).saturate()
        return vec4(hit.mul(depth), hit.mul(0.8).add(0.2), hit.mul(0.6).add(0.4), 1)
}`}
/>