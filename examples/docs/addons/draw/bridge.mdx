---
title: 'bridge'
description: 'Stroke-masked compositing effect for layering content with outlined boundaries'
keywords: [bridge, composite, mask, stroke, layering, cutout]
date: 2025-08-06
---

import { FragmentEditor } from '@site/src/theme/FragmentEditor'

# bridge: Stroke-Masked Compositing

### Masking Mathematics

The `bridge` function creates a compositing effect where content is masked by stroke boundaries, producing a "bridge" or "cutout" appearance. It combines stroke masking with additive composition.

The bridge operation applies:

$$
\text{bridge}(c, d, s, w) = c \cdot (1 - \text{stroke}(d, s, 2w)) + \text{stroke}(d, s, w)
$$

Where c is the content to mask, d is the distance field, s is the stroke threshold, and w controls the stroke width.

### Compositing Layer Structure

The function operates in two phases: masking and addition. First, it multiplies the input content by the inverse of a double-width stroke, creating a cutout region. Then it adds a single-width stroke outline.

This produces content that appears only outside the stroke boundary, with the stroke itself providing a visible border. The double-width masking ensures clean separation between content and stroke regions.

### Multi-Type Support

Bridge functions support scalar, vector2, vector3, and vector4 inputs, maintaining type consistency throughout the operation. The generic version uses automatic type inference for flexible usage across different data types.

The stroke parameters (distance, size, width) remain scalar regardless of content type, providing uniform boundary control across all variants.

<FragmentEditor
        isFun
        code={`
const fragment = () => {
        const p = uv.sub(0.5).mul(4)
        const d1 = p.length().sub(1.2)
        const d2 = p.abs().max().sub(0.8)
        const combined = d1.min(d2)
        const pattern = sin(p.x.mul(8)).add(cos(p.y.mul(6))).mul(0.3).add(0.5)
        const result = bridge(pattern, combined, 0, 0.1)
        return vec4(result.mul(vec3(0.8, 0.9, 0.4)), 1)
}`}
/>

<FragmentEditor
        isFun
        code={`
const fragment = () => {
        const p = uv.sub(0.5).mul(6)
        const grid = p.fract().sub(0.5)
        const cellDist = grid.abs().max().sub(0.3)
        const time = iTime.mul(0.5)
        const colorField = vec3(
                sin(p.x.add(time)),
                cos(p.y.add(time.mul(1.3))),
                sin(p.x.add(p.y).add(time.mul(0.7)))
        ).mul(0.4).add(0.6)
        const strokeWidth = sin(time.add(p.length())).mul(0.03).add(0.08)
        const bridged = bridgeVec3(colorField, cellDist, 0, strokeWidth)
        return vec4(bridged, 1)
}`}
/>